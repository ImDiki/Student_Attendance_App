<Page x:Class="Student_Attendance_System.Views.TeacherDashboard"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      Title="Teacher Dashboard" Background="#F4F6F9" Loaded="Page_Loaded">

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <StackPanel Grid.Row="0" Margin="0,0,0,10">
            <TextBlock Text="先生用ポータル" FontSize="24" FontWeight="Bold" Foreground="#2C3E50"/>
            <TextBlock x:Name="txtCurrentDate" Text="Loading..." Foreground="Gray"/>
        </StackPanel>

        <TabControl Grid.Row="1" x:Name="MainTabControl" Background="Transparent" BorderThickness="0">
            <TabItem Header=" 📅 本日の授業開始 " FontSize="16" Height="40">
                <ScrollViewer VerticalScrollBarVisibility="Auto" Margin="0,10,0,0">
                    <StackPanel x:Name="pnlDailyPeriods">
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <TabItem Header=" 📝 出席管理 " FontSize="16" Height="40">
                <Border Background="White" Margin="0,10,0,0" Padding="20" CornerRadius="10">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        <TextBlock Grid.Row="0" Text="リアルタイム出席リスト" FontWeight="Bold" FontSize="18" Foreground="#2980b9" Margin="0,0,0,10"/>
                        <DataGrid Grid.Row="1" x:Name="dgAttendance" AutoGenerateColumns="False" CanUserAddRows="False" IsReadOnly="True">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="学籍番号" Binding="{Binding StudentID}" Width="*"/>
                                <DataGridTextColumn Header="状態" Binding="{Binding Status}" Width="*"/>
                                <DataGridTextColumn Header="備考" Binding="{Binding Note}" Width="1.5*"/>
                            </DataGrid.Columns>
                        </DataGrid>
                        <StackPanel Grid.Row="2" Margin="0,15,0,0">
                            <TextBlock Text="修正理由（備考）：" FontWeight="SemiBold"/>
                            <Grid Margin="0,5,0,0">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                                <TextBox x:Name="txtReason" Height="35" VerticalContentAlignment="Center" Padding="5"/>
                                <StackPanel Grid.Column="1" Orientation="Horizontal" Margin="10,0,0,0">
                                    <Button Content="出席にする" Background="#27ae60" Foreground="White" Width="100" Click="btnMarkPresent_Click" Margin="0,0,5,0"/>
                                    <Button Content="欠席にする" Background="#c0392b" Foreground="White" Width="100" Click="btnMarkAbsent_Click"/>
                                </StackPanel>
                            </Grid>
                        </StackPanel>
                    </Grid>
                </Border>
            </TabItem>
            <TabItem Header=" 🛑 欠席・遅刻申請 " FontSize="16" Height="40">
                <Border Background="White" Margin="0,10,0,0" Padding="20" CornerRadius="10">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <DataGrid x:Name="dgLeaveRequests"
                      AutoGenerateColumns="False"
                      CanUserAddRows="False"
                      IsReadOnly="True">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="学籍番号" Binding="{Binding StudentID}" Width="*"/>
                                <DataGridTextColumn Header="理由" Binding="{Binding Reason}" Width="2*"/>
                                <DataGridTextColumn Header="申請日" Binding="{Binding RequestDate}" Width="*"/>
                                <DataGridTextColumn Header="状態" Binding="{Binding Status}" Width="*"/>
                            </DataGrid.Columns>
                        </DataGrid>

                        <StackPanel Grid.Row="1" Orientation="Horizontal"
                        HorizontalAlignment="Right" Margin="0,15,0,0">
                            <Button Content="承認"
                        Width="100"
                        Background="#27ae60"
                        Foreground="White"
                        Margin="0,0,10,0"
                        Click="ApproveLeave_Click"/>

                            <Button Content="拒否"
                        Width="100"
                        Background="#c0392b"
                        Foreground="White"
                        Click="RejectLeave_Click"/>
                        </StackPanel>
                    </Grid>
                </Border>
            </TabItem>

        </TabControl>
    </Grid>
</Page>